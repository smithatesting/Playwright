"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createJWTAuthentication = void 0;
const jwt = require("atlassian-jwt");
function createJWTAuthentication(authenticationData, requestData) {
    var _a;
    const { method, url } = requestData;
    const now = Math.floor(Date.now() / 1000);
    const expire = now + ((_a = authenticationData.expiryTimeSeconds) !== null && _a !== void 0 ? _a : 180);
    const request = jwt.fromMethodAndUrl(method, url);
    const tokenData = {
        iss: authenticationData.issuer,
        qsh: jwt.createQueryStringHash(request),
        iat: now,
        exp: expire,
    };
    const token = jwt.encodeSymmetric(tokenData, authenticationData.secret);
    return `JWT ${token}`;
}
exports.createJWTAuthentication = createJWTAuthentication;
//# sourceMappingURL=createJWTAuthentication.js.map